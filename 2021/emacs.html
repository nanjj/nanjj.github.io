<!DOCTYPE HTML>
<html lang="zh_CN" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Emacs</title>


        <!-- Custom HTML head -->

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <!-- <script defer type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
		<script id="MathJax-script" async src="../mathjax/es5/tex-mml-chtml.js"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../2021/ski.html"><strong aria-hidden="true">1.</strong> 滑雪</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../2021/emacs.html" class="active"><strong aria-hidden="true">1.1.</strong> Emacs</a></li><li class="chapter-item "><a href="../2021/swimming.html"><strong aria-hidden="true">1.2.</strong> 游泳</a></li><li class="chapter-item "><a href="../2021/recall-whole-life.html"><strong aria-hidden="true">1.3.</strong> 活着与回忆一生</a></li><li class="chapter-item "><a href="../2021/newton.html"><strong aria-hidden="true">1.4.</strong> 牛吃草问题</a></li><li class="chapter-item "><a href="../2021/math-general-education.html"><strong aria-hidden="true">1.5.</strong> 数学通识教育</a></li><li class="chapter-item "><a href="../2021/mdbook-blog.html"><strong aria-hidden="true">1.6.</strong> Mdbook预处理插件</a></li><li class="chapter-item "><a href="../2021/euler.html"><strong aria-hidden="true">1.7.</strong> 欧拉</a></li><li class="chapter-item "><a href="../2021/emacs-rust-mode.html"><strong aria-hidden="true">1.8.</strong> Emacs Rust Mode</a></li><li class="chapter-item "><a href="../2021/rust.html"><strong aria-hidden="true">1.9.</strong> Rust再学习</a></li></ol></li><li class="chapter-item "><a href="../2019/index.html"><strong aria-hidden="true">2.</strong> Gitlab的持续集成</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../2019/hdituil.html"><strong aria-hidden="true">2.1.</strong> Manipulate Mac Disk Images</a></li><li class="chapter-item "><a href="../2019/lxd.html"><strong aria-hidden="true">2.2.</strong> LXD Inside</a></li></ol></li><li class="chapter-item "><a href="../2018/index.html"><strong aria-hidden="true">3.</strong> Go Debug</a></li><li class="chapter-item "><a href="../2017/index.html"><strong aria-hidden="true">4.</strong> My Kids</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../2017/tips.html"><strong aria-hidden="true">4.1.</strong> Some Tips</a></li><li class="chapter-item "><a href="../2017/freebsd-cloud.html"><strong aria-hidden="true">4.2.</strong> FreeBSD Cloud Init</a></li><li class="chapter-item "><a href="../2017/arista.html"><strong aria-hidden="true">4.3.</strong> Arista on OpenStack</a></li><li class="chapter-item "><a href="../2017/dummynet.html"><strong aria-hidden="true">4.4.</strong> Dummynet</a></li><li class="chapter-item "><a href="../2017/org-publish.html"><strong aria-hidden="true">4.5.</strong> Org Publish</a></li></ol></li><li class="chapter-item "><a href="../2013/index.html"><strong aria-hidden="true">5.</strong> 青春</a></li><li class="chapter-item "><a href="../2011/index.html"><strong aria-hidden="true">6.</strong> 春游</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../2011/love-long-hair.html"><strong aria-hidden="true">6.1.</strong> 我爱长发飘飘</a></li></ol></li><li class="chapter-item "><a href="../2010/index.html"><strong aria-hidden="true">7.</strong> My 2010</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../2010/maolin.html"><strong aria-hidden="true">7.1.</strong> 毛与林集团的斗争</a></li><li class="chapter-item "><a href="../2010/moving-forward.html"><strong aria-hidden="true">7.2.</strong> 勇往直前</a></li><li class="chapter-item "><a href="../2010/iconv.html"><strong aria-hidden="true">7.3.</strong> 繁简转换</a></li><li class="chapter-item "><a href="../2010/possible.html"><strong aria-hidden="true">7.4.</strong> 侧反</a></li><li class="chapter-item "><a href="../2010/eyed3.html"><strong aria-hidden="true">7.5.</strong> eyeD3</a></li><li class="chapter-item "><a href="../2010/liaozhai.html"><strong aria-hidden="true">7.6.</strong> 聊斋</a></li><li class="chapter-item "><a href="../2010/sudden.html"><strong aria-hidden="true">7.7.</strong> 突然想起</a></li><li class="chapter-item "><a href="../2010/my-orchid.html"><strong aria-hidden="true">7.8.</strong> 兰花</a></li><li class="chapter-item "><a href="../2010/salt.html"><strong aria-hidden="true">7.9.</strong> 微薄之盐</a></li><li class="chapter-item "><a href="../2010/snowing-day.html"><strong aria-hidden="true">7.10.</strong> 最中意的雪天</a></li><li class="chapter-item "><a href="../2010/weekend.html"><strong aria-hidden="true">7.11.</strong> 周末了</a></li><li class="chapter-item "><a href="../2010/yefusword.html"><strong aria-hidden="true">7.12.</strong> 野夫的文字</a></li><li class="chapter-item "><a href="../2010/gonggong.html"><strong aria-hidden="true">7.13.</strong> 共工</a></li><li class="chapter-item "><a href="../2010/grass.html"><strong aria-hidden="true">7.14.</strong> 草在结它的种子</a></li><li class="chapter-item "><a href="../2010/old-friend.html"><strong aria-hidden="true">7.15.</strong> 故人</a></li><li class="chapter-item "><a href="../2010/pigeon.html"><strong aria-hidden="true">7.16.</strong> 鸽子</a></li><li class="chapter-item "><a href="../2010/talking-death.html"><strong aria-hidden="true">7.17.</strong> 民不聊生</a></li><li class="chapter-item "><a href="../2010/system.html"><strong aria-hidden="true">7.18.</strong> 系统程序员成长计划</a></li><li class="chapter-item "><a href="../2010/speech-script.html"><strong aria-hidden="true">7.19.</strong> 演讲稿</a></li><li class="chapter-item "><a href="../2010/hushiswords.html"><strong aria-hidden="true">7.20.</strong> 胡适三句话</a></li><li class="chapter-item "><a href="../2010/my-narcissus.html"><strong aria-hidden="true">7.21.</strong> 水仙</a></li><li class="chapter-item "><a href="../2010/my-cousin.html"><strong aria-hidden="true">7.22.</strong> 表哥</a></li><li class="chapter-item "><a href="../2010/dreaming-back-song.html"><strong aria-hidden="true">7.23.</strong> 关于梦回宋朝</a></li><li class="chapter-item "><a href="../2010/sutong.html"><strong aria-hidden="true">7.24.</strong> 苏童河岸</a></li></ol></li><li class="chapter-item "><a href="../2009/index.html"><strong aria-hidden="true">8.</strong> 单翅鸟</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../2009/cicada.html"><strong aria-hidden="true">8.1.</strong> 所谓蝉</a></li><li class="chapter-item "><a href="../2009/our-ancestor.html"><strong aria-hidden="true">8.2.</strong> 我们的祖先</a></li><li class="chapter-item "><a href="../2009/dostoevsky.html"><strong aria-hidden="true">8.3.</strong> 陀思妥耶夫斯基</a></li><li class="chapter-item "><a href="../2009/stories.html"><strong aria-hidden="true">8.4.</strong> 故事汇</a></li><li class="chapter-item "><a href="../2009/that-year.html"><strong aria-hidden="true">8.5.</strong> 那一年</a></li><li class="chapter-item "><a href="../2009/marriage.html"><strong aria-hidden="true">8.6.</strong> 婚姻</a></li><li class="chapter-item "><a href="../2009/lev.html"><strong aria-hidden="true">8.7.</strong> 托尔斯泰与米兰昆德拉</a></li><li class="chapter-item "><a href="../2009/sound-power.html"><strong aria-hidden="true">8.8.</strong> 声音与力量</a></li><li class="chapter-item "><a href="../2009/telling-story.html"><strong aria-hidden="true">8.9.</strong> 叙事</a></li><li class="chapter-item "><a href="../2009/xuanyuan.html"><strong aria-hidden="true">8.10.</strong> 轩辕</a></li><li class="chapter-item "><a href="../2009/cat-trust.html"><strong aria-hidden="true">8.11.</strong> 猫信</a></li><li class="chapter-item "><a href="../2009/relats.html"><strong aria-hidden="true">8.12.</strong> 范德瓦尔斯力</a></li><li class="chapter-item "><a href="../2009/who.html"><strong aria-hidden="true">8.13.</strong> 谁是谁</a></li><li class="chapter-item "><a href="../2009/my-cat.html"><strong aria-hidden="true">8.14.</strong> 我的猫</a></li><li class="chapter-item "><a href="../2009/my-group.html"><strong aria-hidden="true">8.15.</strong> 我的团长我的团</a></li><li class="chapter-item "><a href="../2009/cat-not-easy.html"><strong aria-hidden="true">8.16.</strong> 猫不易</a></li><li class="chapter-item "><a href="../2009/about-two.html"><strong aria-hidden="true">8.17.</strong> 关于二</a></li><li class="chapter-item "><a href="../2009/to-lev.html"><strong aria-hidden="true">8.18.</strong> 致列夫·托尔斯泰</a></li><li class="chapter-item "><a href="../2009/my-vine.html"><strong aria-hidden="true">8.19.</strong> 我的葡萄树</a></li></ol></li><li class="chapter-item "><a href="../2008/index.html"><strong aria-hidden="true">9.</strong> 白鲸</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../2008/archimedes.html"><strong aria-hidden="true">9.1.</strong> 阿基米德</a></li><li class="chapter-item "><a href="../2008/elder.html"><strong aria-hidden="true">9.2.</strong> 父辈</a></li><li class="chapter-item "><a href="../2008/meaning-of-love.html"><strong aria-hidden="true">9.3.</strong> 爱情的意义</a></li><li class="chapter-item "><a href="../2008/a-friend.html"><strong aria-hidden="true">9.4.</strong> 一个朋友</a></li><li class="chapter-item "><a href="../2008/read-zhuangzi.html"><strong aria-hidden="true">9.5.</strong> 读庄子</a></li><li class="chapter-item "><a href="../2008/villages.html"><strong aria-hidden="true">9.6.</strong> 村庄</a></li><li class="chapter-item "><a href="../2008/black-white-iron.html"><strong aria-hidden="true">9.7.</strong> 黑白铁</a></li></ol></li><li class="chapter-item "><a href="../2007/index.html"><strong aria-hidden="true">10.</strong> 测试驱动学习模式</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../2007/hunduns-death-faqs.html"><strong aria-hidden="true">10.1.</strong> 混沌之死问题集锦</a></li><li class="chapter-item "><a href="../2007/hunduns-death.html"><strong aria-hidden="true">10.2.</strong> 混沌之死</a></li><li class="chapter-item "><a href="../2007/emacs-ghost.html"><strong aria-hidden="true">10.3.</strong> Emacs里的有幽灵</a></li><li class="chapter-item "><a href="../2007/a-remote-friend.html"><strong aria-hidden="true">10.4.</strong> 记远方的一个朋友</a></li><li class="chapter-item "><a href="../2007/suolinnang.html"><strong aria-hidden="true">10.5.</strong> 锁麟囊</a></li><li class="chapter-item "><a href="../2007/chunguimeng.html"><strong aria-hidden="true">10.6.</strong> 春闺梦</a></li><li class="chapter-item "><a href="../2007/knocking-stone.html"><strong aria-hidden="true">10.7.</strong> 碰碑</a></li><li class="chapter-item "><a href="../2007/laozis-stories.html"><strong aria-hidden="true">10.8.</strong> 老子的故事汇</a></li><li class="chapter-item "><a href="../2007/cdrecord.html"><strong aria-hidden="true">10.9.</strong> cdrecord的故事汇</a></li><li class="chapter-item "><a href="../2007/life-too-short.html"><strong aria-hidden="true">10.10.</strong> 手工测试生命太短</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Emacs</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/nanjj/nanjj.github.io" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <div style="text-align: right"><code>2021年12月25日 星期六 上午 阴</code></div>
<p>最近<a href="https://lists.gnu.org/archive/html/emacs-devel/2021-12/msg02220.html">Emacs开发</a>少有热闹，大家在讨论迁移<a href="http://www.gnu.org/software/emacs/">Emacs</a>开发到<a href="https://sourcehut.org/">sourcehut</a>的事。</p>
<h2 id="sourcehut"><a class="header" href="#sourcehut"><a href="https://sourcehut.org/">Sourcehut</a></a></h2>
<p><a href="https://sourcehut.org/">Sourcehut</a>是一个开源工具集搭建软件开发平台，提供如下能力：</p>
<ol>
<li><a href="https://git-scm.com/">Git</a>和<a href="https://www.mercurial-scm.org/">Mercurial</a>代码仓托管，</li>
<li>强大持续集成，</li>
<li>基于邮件列表和<a href="https://git-send-email.io/">Git Send Mail</a>的代码检视与合并，</li>
<li>基于邮件的任务（和缺陷）管理，</li>
<li>久经考验的账户管理与安全，</li>
<li>Markdown和Git驱动的Wiki，</li>
<li><a href="https://paste.sr.ht">代码分享</a>，<a href="https://srht.site">静态页面托管</a>，以及与<a href="https://dispatch.sr.ht">第三方服务集成</a></li>
</ol>
<p>几乎每一条都对我特有吸引力！而且竟然是<a href="https://drewdevault.com/">Drew DeVault</a>一人所为！</p>
<p>我拿我的华为<a href="https://www.petalmail.com/">花瓣邮箱</a>注册一个账号，却迟迟收不到确认信。我有些怀疑[花瓣邮箱]存在问题。</p>
<h2 id="花瓣邮箱"><a class="header" href="#花瓣邮箱"><a href="https://www.petalmail.com/">花瓣邮箱</a></a></h2>
<p><a href="https://www.petalmail.com/">花瓣邮箱</a>是华为手机升级鸿蒙后推出的一个应用。当时我刚好没有合适的主力邮箱可用，就欣然接受，打算有时间把邮箱用起来。</p>
<h3 id="国内邮箱"><a class="header" href="#国内邮箱">国内邮箱</a></h3>
<p>除了<a href="https://www.petalmail.com/">花瓣邮箱</a>，我还有三个邮箱：</p>
<ol>
<li><a href="https://mail.gmail.com">Gmail</a>，</li>
<li><a href="https://mail.qq.com">QQ Mail</a>，</li>
<li><a href="https://mail.10086.cn/">139邮箱</a>。</li>
</ol>
<h3 id="gmail的使用"><a class="header" href="#gmail的使用">Gmail的使用</a></h3>
<p>我之前主力邮箱是<a href="https://mail.gmail.com">Gmail</a>。<a href="https://mail.gmail.com">Gmail</a>在没有合适代理的情况下在国内很难直接使用。我把<a href="https://mail.gmail.com">Gmail</a>邮箱配置在<a href="https://mail.qq.com">QQ Mail</a>的手机客户端里，<a href="https://mail.qq.com">QQ Mail</a>帮我翻墙出去，我勉强可以收发信。可谓细若游丝，命悬一线地在用。使用场景也剩下唯一的一个：发电子书到Kindle邮箱。亚马逊有个服务听在那，把附件转化后推到我的Kindle上。</p>
<p>因此在国内<a href="https://mail.gmail.com">Gmail</a>作为主力邮箱是不合适的。</p>
<h3 id="深入花瓣"><a class="header" href="#深入花瓣">深入花瓣</a></h3>
<p>如今仔细看<a href="https://www.petalmail.com/">花瓣邮箱</a>，发现其目前只支持手机客户端和Web客户端收发信，不支持任何一种协议包括POP3，IMAP以及SMTP协议。<a href="https://www.petalmail.com/">花瓣邮箱</a>也没有帮助文档，当你需要帮助的时候，“智能助手”跳出来回答你的问题，是问答式的，经常所答非所问。勉强从一个问题回答的侧面推断出<a href="https://www.petalmail.com/">花瓣邮箱</a>暂不支持第三方客户端，也就是不支持POP3, IMAP以及SMTP协议。另外我迟迟收不到确认信。基本打消了我把<a href="https://www.petalmail.com/">花瓣邮箱</a>作为我的主力邮箱，配置在Emacs里使用的x想法。</p>
<h3 id="qq邮箱"><a class="header" href="#qq邮箱">QQ邮箱</a></h3>
<p><a href="https://mail.qq.com">QQ Mail</a>倒是支持主流协议，但需要打开一下。在打开IMAP和SMTP协议支持的候，<a href="https://mail.qq.com">QQ Mail</a>提示下载QQ，做一些安全方面的校验。但我在Linux下到哪里去下载QQ呢？链接指向了一个Windows QQ下载。难道是要我用<a href="https://www.winehq.org/">Wine</a>将其灌醉，然后加载运行吗？这种无脑设计让人不知道说什么。最终放弃扶正QQ邮箱的打算。</p>
<h3 id="139邮箱"><a class="header" href="#139邮箱">139邮箱</a></h3>
<p><a href="https://mail.10086.cn/">139邮箱</a>提的口号是手机号就是邮箱。但手机号当邮箱使用又有手机暴露的风险。这也是我一直没有怎么正经用的原因。如今回头重新看139信箱，发现它提供了邮箱别名的功能。选名的过程中发现<a href="https://mail.10086.cn/">139邮箱</a>帮助文档非常详实，各种协议支持完备。打开协议支持也需要一些安全方面的验证，但是使用的是手机验证。那这就方便多了。</p>
<p>在<a href="http://www.gnu.org/software/emacs/">Emacs</a>配好<a href="https://mail.10086.cn/">139邮箱</a>后给<a href="https://drewdevault.com/">Drew DeVault</a>发信，问他确认信没收到的事。他很快回信，告诉我花瓣可能哪里配置的不对，他发到我花瓣的信被退回来了。这证实了我的猜测。</p>
<h3 id="正告花瓣"><a class="header" href="#正告花瓣">正告花瓣</a></h3>
<p>这里正告<a href="https://www.petalmail.com/">花瓣邮箱</a>:</p>
<ol>
<li>
<p>老老实实把基本功能做好</p>
<p>邮箱一定要能收发信，收不到信的邮箱叫什么鬼邮箱？！</p>
</li>
<li>
<p>老老实实去支持基本的协议</p>
<p>支持IMAP和SMTP协议，方便第三方客户端配置，而不要贸然以云之名把这些历史沉淀下来的东西扬弃。</p>
</li>
<li>
<p>老老实实去写帮助文档</p>
<p>用一个所谓<code>智能助手</code>的东西去糊弄是不行的。</p>
</li>
</ol>
<h3 id="gnus"><a class="header" href="#gnus">Gnus</a></h3>
<p>于是重回Gnus怀抱。配置信箱，订阅邮件列表，写信，读信。</p>
<p>读Gnus的info文档，拉倒最后，有一首小诗：</p>
<pre><code>     *Te Deum*


     Not because of victories
     I sing,
     having none,
     but for the common sunshine,
     the breeze,
     the largess of the spring.


     Not for victory
     but for the day’s work done
     as well as I was able;
     not for a seat upon the dais
     but at the common table.

</code></pre>
<p>这首诗让我莫名感动。</p>
<h3 id="新闻组"><a class="header" href="#新闻组">新闻组</a></h3>
<p>新闻组已死。国内只剩新帆（news.newsfan.net）一息尚存，也没啥有用信息。
Emacs Gnus对新闻组里中文的支持，在历次重构过程中给弄没了。有人在开发邮件列表里提讨论，可能有很好的挽救方案。国外的新闻组感觉也没啥新内容。但邮件列表的确是很好的沟通方式。</p>
<h3 id="邮件列表"><a class="header" href="#邮件列表">邮件列表</a></h3>
<p>Emacs开发一直用邮件列表沟通。除此外我感兴趣的，比如：</p>
<ol>
<li><a href="https://discuss.linuxcontainers.org/">Linux Containers</a>,</li>
<li><a href="https://users.rust-lang.org/">Rust Lang</a>,</li>
<li><a href="https://forum.graphviz.org/">Graphviz</a></li>
</ol>
<p>等，背后都是邮件列表的运作模式：</p>
<ol>
<li>一个Web前端， 满足习惯Web界面的用户需求，</li>
<li>可订阅的邮件列表，满足习惯邮件订阅的用户需求。</li>
</ol>
<p>我觉得对程序员而言，对散布在世界各地的程序员而言，邮件仍然是最有效的沟通方式。国内常用微信群，有效的沟通很难展开，有价值的信息很快淹没在信息的洪流里。还有就是微信公众号，是一种单向沟通，离协作差得远了。</p>
<p>因此还是简单干净的邮件，把大家联系起来。通过邮件协作，通过邮件驱动学习。驱动开发，以至于整个开发流程，可能是一个现实的方向。</p>
<p>邮件驱动整个开发也是Linux内核开发的主要模式。为此<a href="https://sourcehut.org/">Sourcehut</a>专门写了个网站<a href="https://git-send-email.io">Git Send Email</a>来说这件事。</p>
<h3 id="git-send-email"><a class="header" href="#git-send-email"><a href="https://git-send-email.io">Git Send Email</a></a></h3>
<p>我按其步骤一步步走下来，基本是工作的，除了最后的发的信被退回。我把退信扔给Drew看，看发生了什么。</p>
<p><code>git send-email</code>是Git内嵌命令，虽然是内嵌命令，一般的Linux发行版还是会分开打包，比如Ubuntu：</p>
<pre><code class="language-bash">apt-get install git-email
</code></pre>
<p><code>git send-email</code>可以把需要的变更以email的形式发出去，发到邮件列表或者某个代码仓的维护者。内容基本上是<code>git format-patch</code>的生成。因此在<code>~/.gitconfig</code>需要配置（也可通过<code>git config --edit --global</code>来改)：</p>
<pre><code>[sendemail]
	smtpserver = &lt;smtp server&gt;
	smtpuser = &lt;smtp user&gt;
	smtpencryption = ssl
	smtpserverport = 465
</code></pre>
<p>在代码仓的<code>.git/config</code>（也可以用<code>git config --edit</code>修改):</p>
<pre><code>[sendemail]
	to = &lt;the git repo's email list or owner's email&gt;
</code></pre>
<p>我相信邮件驱动的开发流程是有效的。</p>
<h3 id="邮件驱动开发"><a class="header" href="#邮件驱动开发">邮件驱动开发</a></h3>
<p>这里把邮件驱动的开发梳理一下。</p>
<div><!-- Generated by graphviz version 2.40.1 (20161225.0304)
 --><!-- Title: %3 Pages: 1 --><svg width="517pt" height="527pt"
 viewBox="0.00 0.00 516.67 527.35" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 523.3489)"><title>%3</title><polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-523.3489 512.6747,-523.3489 512.6747,4 -4,4"/><!-- D --><g id="node1" class="node"><title>D</title><ellipse fill="none" stroke="#000000" cx="38.3466" cy="-428.3489" rx="38.1938" ry="18"/><text text-anchor="middle" x="38.3466" y="-424.6489" font-family="Times,serif" font-size="14.00" fill="#000000">开发者</text></g><!-- C --><g id="node2" class="node"><title>C</title><ellipse fill="none" stroke="#000000" cx="168.9908" cy="-345.3489" rx="27.0966" ry="18"/><text text-anchor="middle" x="168.9908" y="-341.6489" font-family="Times,serif" font-size="14.00" fill="#000000">Chat</text></g><!-- D&#45;&gt;C --><g id="edge1" class="edge"><title>D&#45;&gt;C</title><path fill="none" stroke="#000000" d="M55.1667,-411.9457C65.9035,-402.0185 80.4388,-389.5442 94.6932,-380.3489 107.6129,-372.0146 122.8303,-364.4918 136.1176,-358.5754"/><polygon fill="#000000" stroke="#000000" points="137.6036,-361.7461 145.3913,-354.5626 134.8237,-355.3217 137.6036,-361.7461"/><text text-anchor="middle" x="109.1932" y="-384.1489" font-family="Times,serif" font-size="14.00" fill="#000000">聊天</text></g><!-- L --><g id="node3" class="node"><title>L</title><ellipse fill="none" stroke="#000000" cx="460.579" cy="-434.3489" rx="48.1917" ry="18"/><text text-anchor="middle" x="460.579" y="-430.6489" font-family="Times,serif" font-size="14.00" fill="#000000">邮件列表</text></g><!-- D&#45;&gt;L --><g id="edge3" class="edge"><title>D&#45;&gt;L</title><path fill="none" stroke="#000000" d="M76.9382,-429.1035C133.7672,-430.1902 243.3096,-432.1922 336.4833,-433.3489 357.8618,-433.6143 381.3129,-433.8242 402.0174,-433.9818"/><polygon fill="#000000" stroke="#000000" points="402.2275,-437.4833 412.253,-434.0572 402.2791,-430.4835 402.2275,-437.4833"/><text text-anchor="middle" x="228.7884" y="-435.1489" font-family="Times,serif" font-size="14.00" fill="#000000">补丁</text></g><!-- D&#45;&gt;L --><g id="edge6" class="edge"><title>D&#45;&gt;L</title><path fill="none" stroke="#000000" d="M75.6906,-423.9627C111.2602,-420.0199 166.3368,-414.5248 214.2884,-412.3489 280.6884,-409.336 356.8626,-418.0152 406.6985,-425.3456"/><polygon fill="#000000" stroke="#000000" points="406.2023,-428.8102 416.6118,-426.8372 407.2438,-421.8882 406.2023,-428.8102"/><text text-anchor="middle" x="228.7884" y="-416.1489" font-family="Times,serif" font-size="14.00" fill="#000000">意见</text></g><!-- D&#45;&gt;L --><g id="edge8" class="edge"><title>D&#45;&gt;L</title><path fill="none" stroke="#000000" d="M46.6493,-446.1139C55.7481,-463.2592 72.1136,-488.2085 94.6932,-499.3489 118.0104,-510.8533 393.5405,-499.7421 394.4833,-499.3489 413.8538,-491.2701 430.6407,-474.5553 442.4497,-460.0991"/><polygon fill="#000000" stroke="#000000" points="445.4276,-461.9716 448.8094,-451.931 439.9043,-457.6712 445.4276,-461.9716"/><text text-anchor="middle" x="228.7884" y="-508.1489" font-family="Times,serif" font-size="14.00" fill="#000000">Bug</text></g><!-- D&#45;&gt;L --><g id="edge9" class="edge"><title>D&#45;&gt;L</title><path fill="none" stroke="#000000" d="M70.5835,-438.1257C78.4087,-440.166 86.7972,-442.0802 94.6932,-443.3489 226.2575,-464.4889 261.9938,-461.5827 394.4833,-447.3489 399.2471,-446.8371 404.1789,-446.1562 409.103,-445.3734"/><polygon fill="#000000" stroke="#000000" points="409.8819,-448.7909 419.1431,-443.645 408.6943,-441.8924 409.8819,-448.7909"/><text text-anchor="middle" x="228.7884" y="-462.1489" font-family="Times,serif" font-size="14.00" fill="#000000">特性</text></g><!-- E --><g id="node8" class="node"><title>E</title><ellipse fill="none" stroke="#000000" cx="289.8858" cy="-240.3489" rx="28.6953" ry="18"/><text text-anchor="middle" x="289.8858" y="-236.6489" font-family="Times,serif" font-size="14.00" fill="#000000">EBot</text></g><!-- C&#45;&gt;E --><g id="edge13" class="edge"><title>C&#45;&gt;E</title><path fill="none" stroke="#000000" d="M185.8007,-330.7491C206.4356,-312.8272 241.5978,-282.2881 265.2765,-261.7226"/><polygon fill="#000000" stroke="#000000" points="267.574,-264.363 272.8289,-255.1632 262.9839,-259.0781 267.574,-264.363"/><text text-anchor="middle" x="228.7884" y="-308.1489" font-family="Times,serif" font-size="14.00" fill="#000000">记录</text></g><!-- L&#45;&gt;E --><g id="edge12" class="edge"><title>L&#45;&gt;E</title><path fill="none" stroke="#000000" d="M437.3041,-418.4973C424.8989,-410.4154 409.198,-400.7565 394.4833,-393.3489 369.7142,-380.8798 355.7621,-390.2817 336.4833,-370.3489 309.3168,-342.2608 297.8543,-297.2444 293.1112,-268.2399"/><polygon fill="#000000" stroke="#000000" points="296.5727,-267.7217 291.6511,-258.3394 289.6476,-268.7431 296.5727,-267.7217"/><text text-anchor="middle" x="365.4833" y="-397.1489" font-family="Times,serif" font-size="14.00" fill="#000000">侦听</text></g><!-- G --><g id="node4" class="node"><title>G</title><ellipse fill="none" stroke="#000000" cx="460.579" cy="-316.3489" rx="38.1938" ry="18"/><text text-anchor="middle" x="460.579" y="-312.6489" font-family="Times,serif" font-size="14.00" fill="#000000">代码仓</text></g><!-- B --><g id="node5" class="node"><title>B</title><ellipse fill="none" stroke="#000000" cx="460.579" cy="-202.3489" rx="29.4969" ry="18"/><text text-anchor="middle" x="460.579" y="-198.6489" font-family="Times,serif" font-size="14.00" fill="#000000">构建</text></g><!-- S --><g id="node6" class="node"><title>S</title><ellipse fill="none" stroke="#000000" cx="460.579" cy="-88.3489" rx="29.4969" ry="18"/><text text-anchor="middle" x="460.579" y="-84.6489" font-family="Times,serif" font-size="14.00" fill="#000000">网站</text></g><!-- T --><g id="node7" class="node"><title>T</title><ellipse fill="none" stroke="#000000" cx="460.579" cy="-23.3489" rx="35.194" ry="18"/><text text-anchor="middle" x="460.579" y="-19.6489" font-family="Times,serif" font-size="14.00" fill="#000000">TODO</text></g><!-- E&#45;&gt;D --><g id="edge7" class="edge"><title>E&#45;&gt;D</title><path fill="none" stroke="#000000" d="M263.2938,-247.4432C232.0154,-256.691 179.562,-275.0975 141.6932,-303.3489 104.789,-330.8808 72.8653,-374.2391 54.6159,-401.9737"/><polygon fill="#000000" stroke="#000000" points="51.4438,-400.4344 48.9637,-410.7349 57.326,-404.2292 51.4438,-400.4344"/><text text-anchor="middle" x="168.9908" y="-307.1489" font-family="Times,serif" font-size="14.00" fill="#000000">检视</text></g><!-- E&#45;&gt;L --><g id="edge15" class="edge"><title>E&#45;&gt;L</title><path fill="none" stroke="#000000" d="M296.8189,-258.1313C304.3955,-275.7121 317.9691,-302.4998 336.4833,-320.3489 357.5256,-340.6354 372.026,-332.6408 394.4833,-351.3489 414.0077,-367.6138 431.6831,-390.4516 443.8326,-408.055"/><polygon fill="#000000" stroke="#000000" points="441.1767,-410.3775 449.6628,-416.7208 446.9846,-406.47 441.1767,-410.3775"/><text text-anchor="middle" x="365.4833" y="-355.1489" font-family="Times,serif" font-size="14.00" fill="#000000">结果</text></g><!-- E&#45;&gt;G --><g id="edge4" class="edge"><title>E&#45;&gt;G</title><path fill="none" stroke="#000000" d="M305.0867,-255.8218C313.6691,-263.8106 324.9618,-273.1543 336.4833,-279.3489 360.9128,-292.4837 390.618,-301.5519 414.8398,-307.4225"/><polygon fill="#000000" stroke="#000000" points="414.3212,-310.8951 424.8535,-309.7452 415.903,-304.0761 414.3212,-310.8951"/><text text-anchor="middle" x="365.4833" y="-305.1489" font-family="Times,serif" font-size="14.00" fill="#000000">合入</text></g><!-- E&#45;&gt;B --><g id="edge5" class="edge"><title>E&#45;&gt;B</title><path fill="none" stroke="#000000" d="M295.2204,-222.6537C301.7253,-204.5766 314.645,-177.4908 336.4833,-165.3489 367.4179,-148.1495 407.2382,-166.0989 433.315,-182.4698"/><polygon fill="#000000" stroke="#000000" points="431.6502,-185.564 441.9285,-188.1344 435.4965,-179.7154 431.6502,-185.564"/><text text-anchor="middle" x="365.4833" y="-169.1489" font-family="Times,serif" font-size="14.00" fill="#000000">构建</text></g><!-- E&#45;&gt;B --><g id="edge14" class="edge"><title>E&#45;&gt;B</title><path fill="none" stroke="#000000" d="M292.4392,-222.0604C296.8207,-198.478 308.2165,-158.3623 336.4833,-140.3489 358.2221,-126.4956 370.5131,-130.866 394.4833,-140.3489 413.684,-147.945 430.5693,-164.0477 442.4668,-177.9386"/><polygon fill="#000000" stroke="#000000" points="439.8373,-180.2521 448.8753,-185.7807 445.2576,-175.8226 439.8373,-180.2521"/><text text-anchor="middle" x="365.4833" y="-144.1489" font-family="Times,serif" font-size="14.00" fill="#000000">测试</text></g><!-- E&#45;&gt;B --><g id="edge16" class="edge"><title>E&#45;&gt;B</title><path fill="none" stroke="#000000" d="M313.7779,-250.4701C335.3972,-258.1304 367.836,-265.8504 394.4833,-256.3489 411.7715,-250.1846 427.8038,-237.3433 439.7481,-225.7295"/><polygon fill="#000000" stroke="#000000" points="442.4753,-227.9474 446.979,-218.3574 437.4779,-223.0457 442.4753,-227.9474"/><text text-anchor="middle" x="365.4833" y="-264.1489" font-family="Times,serif" font-size="14.00" fill="#000000">集成</text></g><!-- E&#45;&gt;B --><g id="edge17" class="edge"><title>E&#45;&gt;B</title><path fill="none" stroke="#000000" d="M317.4635,-234.7852C338.5826,-230.4673 368.4199,-224.2431 394.4833,-218.3489 403.8703,-216.2261 413.9808,-213.8329 423.4023,-211.5567"/><polygon fill="#000000" stroke="#000000" points="424.3994,-214.9163 433.2884,-209.1512 422.7444,-208.1148 424.3994,-214.9163"/><text text-anchor="middle" x="365.4833" y="-235.1489" font-family="Times,serif" font-size="14.00" fill="#000000">部署</text></g><!-- E&#45;&gt;B --><g id="edge18" class="edge"><title>E&#45;&gt;B</title><path fill="none" stroke="#000000" d="M303.1136,-223.9232C311.5655,-214.7896 323.377,-204.294 336.4833,-199.3489 364.1289,-188.918 397.7583,-190.5209 423.0317,-194.2595"/><polygon fill="#000000" stroke="#000000" points="422.5278,-197.7236 432.9646,-195.9005 423.6689,-190.8172 422.5278,-197.7236"/><text text-anchor="middle" x="365.4833" y="-203.1489" font-family="Times,serif" font-size="14.00" fill="#000000">升级</text></g><!-- E&#45;&gt;S --><g id="edge2" class="edge"><title>E&#45;&gt;S</title><path fill="none" stroke="#000000" d="M291.1339,-222.0837C294.0668,-194.2044 303.8606,-141.3305 336.4833,-113.3489 359.6777,-93.4543 394.2846,-87.7957 421.0645,-86.7778"/><polygon fill="#000000" stroke="#000000" points="421.3346,-90.2736 431.2704,-86.5953 421.2094,-83.2748 421.3346,-90.2736"/><text text-anchor="middle" x="365.4833" y="-117.1489" font-family="Times,serif" font-size="14.00" fill="#000000">发布</text></g><!-- E&#45;&gt;T --><g id="edge10" class="edge"><title>E&#45;&gt;T</title><path fill="none" stroke="#000000" d="M290.7663,-222.1893C293.5626,-173.1211 304.059,-39.7934 336.4833,-13.3489 360.7248,6.4219 397.2189,.6422 424.3641,-8.1175"/><polygon fill="#000000" stroke="#000000" points="423.3071,-11.4555 433.902,-11.4378 425.6085,-4.8446 423.3071,-11.4555"/><text text-anchor="middle" x="365.4833" y="-17.1489" font-family="Times,serif" font-size="14.00" fill="#000000">问题跟踪</text></g><!-- E&#45;&gt;T --><g id="edge11" class="edge"><title>E&#45;&gt;T</title><path fill="none" stroke="#000000" d="M292.7659,-222.2849C299.2792,-183.4698 316.1674,-93.806 336.4833,-71.3489 357.1642,-48.4883 390.0061,-36.418 416.7102,-30.1005"/><polygon fill="#000000" stroke="#000000" points="417.5772,-33.4939 426.6061,-27.9504 416.0909,-26.6535 417.5772,-33.4939"/><text text-anchor="middle" x="365.4833" y="-75.1489" font-family="Times,serif" font-size="14.00" fill="#000000">特性跟踪</text></g></g></svg></div>
<p>开发者在聊天室和邮件列表交流，沟通，提特性，发Patch，相互代码检视，并不直接操作代码仓。邮件列表和聊天室里有一个EBot，默默关注这一切。EBot负责代码检视流程的推动，负责代码合入，负责调用构建服务来测试代码，负责使用构建服务来集成代码，完成CI，负责部署，升级来完成CI。负责发布文档到网站服务，负责特性跟踪和Bug跟踪到TODO服务，负责记录邮件列表和聊天内容，并归档到网站服务。</p>
<p>这是<a href="https://sourcehut.org/">Sourcehut</a>正在做和正要做的特性。这些特性要以100%开源的形式做出了。</p>
<p>这些特性深深吸引了Emacs的开发者：</p>
<pre><code>站在能分割世界的桥
还是看不清
在那些时刻
遮蔽我们
黑暗的心
究竟是什么

住在我心里孤独的
孤独的海怪
痛苦之王
开始厌倦
深海的光
停滞的海浪

站在能看到灯火的桥
还是看不清
在那些夜晚
照亮我们
黑暗的心
究竟是什么

于是他默默追逐着
横渡海峡
年轻的人
看着他们
为了彼岸
骄傲地
灭亡
</code></pre>
<h3 id="协作开发现状"><a class="header" href="#协作开发现状">协作开发现状</a></h3>
<p>一般的公司，都会有一个代码仓服务。一般是基于Git，要么Github企业版，
Gitlab或者自研的一个Git。这会是个核心。</p>
<p>围绕核心Git服务，会搭建流水线，这时候的备选有以下几种风格：</p>
<ol>
<li>Jenkins，</li>
<li>Travis，</li>
<li>Gitlab CI/CD</li>
</ol>
<p>有一个需求管理系统，有缺陷管理系统。 这里的备选有：</p>
<ol>
<li>Github/Gitlab Issues，</li>
<li>Bugzilla，</li>
<li>工单系统，需求单系统等。</li>
</ol>
<p>需求、缺陷写到Git Commit消息里，会有一些约定，比如#需求号或#缺陷号。这样需求，缺陷就和代码关联起来了。 这块基本跟随Github/Gitlab Issues的处理办法。</p>
<p>代码检视主要跟随Github/Gitlab MR或PR的做法。</p>
<p>程序员之间沟通基本靠开会。也有公司意识到会太多会限制开会。会议会有会议纪要，会议纪要要执行。因此还有一个会议系统。</p>
<p>CI/CD这些就归到流水线了。而一谈流水线，Jenkins就又复活了。</p>
<p>Github Pages也有在用， Wikis也在用，文档管理工具也在用。信息散布各处，形成信息孤岛。</p>
<p>程序员基本活在各种流程和系统里，被流程和系统追着跑。</p>
<h2 id="emacs的开发"><a class="header" href="#emacs的开发">Emacs的开发</a></h2>
<p>现在你在Emacs里可以打开<code>sqlite</code>数据库文件，看到里面的表结构，展示表里的数据。这有什么用呢？看起来酷酷的，不过好像也没什么用。因为之前你用<code>sqlite3</code>也可以看，而且Emacs和<code>sqlite3</code>早有合作。</p>
<p>现在你可以用Elisp写单元测试，单元测试的最后一个警告也已消除，单元测试可以生成JUnit的测试报告，方便集成到Emacs的CI/CD环境中去。这有什么用呢？这也没啥用，因为Emacs根本就没有CI/CD环境。</p>
<p>我看到比较有用的是<code>xwidget-webkit-browse-url</code>，在Emacs里启动一个足够现代的浏览器窗口，配合<code>mdbook</code>(或者<code>hugo</code>之类)，做到实时显示<code>Markdown</code>的内容：</p>
<p><img src="xwidget.jpg" alt="" /> </p>
<h2 id="sourcehut的迁移"><a class="header" href="#sourcehut的迁移"><a href="https://sourcehut.org/">Sourcehut</a>的迁移</a></h2>
<p>回到迁移<a href="http://www.gnu.org/software/emacs/">Emacs</a>开发到<a href="https://sourcehut.org/">sourcehut</a>的事。这件事<a href="https://stallman.org">Richard Stallman</a>也发话了，明确不可以用<a href="https://sourcehut.org/">Sourcehut</a>提供的服务，但可以用<a href="https://sourcehut.org/">Sourcehut</a>提供的软件。</p>
<p>Emacs基本没有一个现代的CI流程来保证代码质量。<a href="https://stallman.org">Richard Stallman</a>政治性强，理想主义，很多时候不切实际，也没给Emacs弄个像样的CI。就算源码控制工具的选择都一波三折。直到2014年初，才由<a href="http://www.catb.org/%7Eesr/">Eric S. Raymond</a>拨乱反正，花了将近一年的时间，到2014年底，把Emacs拉到了Git的正轨上来。</p>
<p>如今<a href="https://sourcehut.org/">Sourcehut</a>横空出世，众Emacer可算盼到救星了。 <a href="https://lars.ingebrigtsen.no/">Lars Ingebrigtsen</a>
写到：</p>
<blockquote>
<p>我有个梦想，当我提交一个变更，能有一个CI系统在一分钟内告诉我，在哪些系统上构建不过。但我猜这梦想不会实现，除非自由软件基金会有它应有的钱。</p>
</blockquote>
<p>提起来让人心酸。这又算多高的梦想呢？又有多难实现呢？ Óscar Fuentes写到：</p>
<blockquote>
<p>Emacs在我3.66GHz 8核构建机器上大约用时两分钟，这一半耗时是单线程所致（我对构建过程有一个长的分析）。因此降到一分钟似乎不难。</p>
<p>但说服某人买一台CI服务器估计美梦永不成真。</p>
</blockquote>
<p><a href="https://lars.ingebrigtsen.no/">Lars Ingebrigtsen</a>说：</p>
<blockquote>
<p>是的，也只在梦中我有闲钱，给自由软件基金会捐一台64核的服务器：）</p>
</blockquote>
<h2 id="buildssrht"><a class="header" href="#buildssrht"><a href="https://builds.sr.ht">builds.sr.ht</a></a></h2>
<p><a href="https://builds.sr.ht">builds.sr.ht</a>用虚拟机跑CI。构建失败后保留虚拟机10分钟，可以<code>ssh</code>上去看到底出了啥事，为啥失败。</p>
<p>对比其他工具，如<a href="https://travis-ci.org">Travis</a>等基于Docker容器的，有很大易用性方面的提高。但基于虚机构建成本很高，而且用时较长（虚机从创建到启动到跑完CI，慢的可以到20分钟）。</p>
<p>这块最合适是系统容器<a href="https://github.com/lxc/lxd">LXD</a>。我把这个提议提给了<a href="https://drewdevault.com/">Drew DeVault</a>，但没得到他的回应。我在等待回应的时间里，大致看了他的实现。他任务跑在虚机里，虚机跑在Docker容器里，Docker容器跑在物理机上。这样他使用了Docker的镜像能力，也更安全。只是成本还是太高。</p>
<p>反复考察，我感觉<a href="https://github.com/lxc/lxd">LXD</a>系统容器还是更适合跑任务。</p>
<h2 id="srhtsite"><a class="header" href="#srhtsite"><a href="https://srht.site">srht.site</a></a></h2>
<p><a href="https://srht.site">srht.site</a>对标github的pages功能。对外只有一个Rest API：</p>
<pre><code>curl --oauth2-bearer secret \
	-Fcontent=site.tar.gz https://pages.sr.ht/publish/nanjj.srht.site
</code></pre>
<p>｀site.tar.gz`是全量网站的打包。这命令还有一个变种：</p>
<pre><code>curl --oauth2-bearer secret \
	-Fcontent=sub.tar.gz https://pages.sr.ht/publish/nanjj.srht.site/sub
</code></pre>
<p>用于更新网站的一个子目录。</p>
<p>这基本就足够了，实现好了足以对标Github。</p>
<p>我把自己的小站搬到了<a href="https://srht.site">srht.site</a>:</p>
<p><a href="https://nanjj.srht.site">https://nanjj.srht.site</a></p>
<p>发现两个问题。</p>
<p>第一个问题，<a href="https://srht.site">srht.site</a>不支持js跨域。</p>
<p>我的站点有两个需要跨域的功能：</p>
<ol>
<li><a href="https://mathjax.org">MathJax</a>，</li>
<li><a href="https://utteranc.es">Utteranc</a>。</li>
</ol>
<p><a href="https://mathjax.org">MathJax</a>其实好办，拿过来就是。<a href="https://utteranc.es">Utteranc</a>就不好弄了。还好我看留言并不多，于是干脆去掉了。</p>
<p>第二个问题是<a href="https://srht.site">srht.site</a>没有用浏览器的cache功能，导致每次加载都要重新下载，以至于和</p>
<p><a href="https://nanjj.github.io">https://nanjj.github.io</a></p>
<p>比较就慢多了。 这个问题我感觉<a href="https://srht.site">srht.site</a>可以优化。在第二个问题解决之前，我的小站继续以github为主。</p>

                    </main>
					<!-- script src="https://utteranc.es/client.js" repo="nanjj/nanjj.github.io" issue-term="pathname" crossorigin="anonymous"></script-->
                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../2021/ski.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../2021/swimming.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../2021/ski.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../2021/swimming.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
